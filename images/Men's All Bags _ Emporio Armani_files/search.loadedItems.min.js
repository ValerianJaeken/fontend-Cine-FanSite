define(["ytos.search"],function(){return yTos.utils.namespace("yTos.helpers.Search.LoadedItems"),yTos.helpers.Search.LoadedItems=yTos.helpers.base.extend({initialize:function(){this.model=yTos.models.Searches({scope:"mainSearch"}),this.updateHtml()},globalMessages:{"yTos::Search::ProductsReady":"updateHtml"},updateHtml:function(){var a=this.getApiRequest(),b=$Y.prepareData({productsPerPage:this.options.productsPerPage,pagesLoaded:Number(yTos.search.page)-1,Options:{SiteCode:this.options.siteCode,Gender:a.gender,ApiRequest:$Y.jsonToQueryString(a)}});this.postHTML({Plugin:"Search",Action:"RenderLoadedItemsAsync"},{success:function(a){$Y.notify("yTos::Search::LoadedItemsRefreshed",{content:a})}.bind(this),data:b,autoUpdate:!0,stripMe:!0})},getApiRequest:function(){var a=this.model.get("filters");return $Y.mixin({},a,!0)}}),yTos.helpers.Search.LoadedItems});