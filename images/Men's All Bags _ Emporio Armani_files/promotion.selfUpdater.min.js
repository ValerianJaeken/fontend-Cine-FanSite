define(["ui.slider"],function(a){return yTos.utils.namespace("yTos.helpers.Promotion.SelfUpdater"),yTos.helpers.Promotion.SelfUpdater=yTos.helpers.base.extend({slider:a,initialize:function(){this.options.settings.IsSliderEnabled&&(this.slider=new this.slider(this.el)),this.availableModes=["list","horizontal","vertical","fade"],this.updatePromotions()},defaults:{SliderPeriodMs:3e3,SlidingEffectDurationMs:750,PromotionApplied:0},globalMessages:function(){var a={"yTos::Promotion::RestartSlider":"reloadSlider"};return this.options.data.PromotionsOptions.ShouldRefresh&&(a["yTos::Cart::ItemsInCartUpdated"]="updatePromotions",a["yTos::Cart::ItemQuantityUpdated"]="updatePromotions",a["yTos::Cart::ItemsInCartQuantityUpdated"]="updatePromotions",a["yTos::Cart::ItemRemoved"]="updatePromotions",a["yTos::Cart::ItemsDeleted"]="updatePromotions",a["yTos::Account::UserLoggedIn"]="updatePromotions",a["yTos::Account::AllItemsAddedFromWishList"]="updatePromotions",a["yTos::Account::UserLoggedOut"]="updatePromotions",a["yTos::Item::NotifyColorChanged"]="checkColorChanged",a["yTos::Cart::ItemsAdded"]="updatePromotions",a["yTos::Item::ItemAdded"]="updatePromotions",a["yTos::Item::ItemAddedToShoppingBag"]="updatePromotions"),a},updatePromotions:function(){this.getHTML("/yTos/Plugins/PromotionPlugin/RenderDynamicPromotionsAsync",{data:$Y.prepareData({promotionsOptions:this.options.data.PromotionsOptions,code10:this.options.data.Code10,promotionsApplied:this.options.data.PromotionApplied||this.defaults.PromotionApplied,printNoPromotionsLabel:this.options.data.PromotionsOptions.PrintNoPromotionsLabel||!1}),success:$.proxy(function(a){this.notify("yTos::Promotion::PromotionUpdated",a),this.options.settings.IsSliderEnabled&&this.notify("yTos::Ui::Slider::InitSlider",{$slider:this.$el.find("[data-ytos-promotionsList]"),settings:{sliderElement:"[data-ytos-promo]",mode:this.availableModes[this.options.data.PromotionsOptions.PromotionLayoutTypes],pause:this.options.data.PromotionsOptions.SliderPeriodMs||this.defaults.SliderPeriodMs,speed:this.options.data.PromotionsOptions.SlidingEffectDurationMs||this.defaults.SlidingEffectDurationMs}},{scope:this.scope})},this),stripMe:!0,autoUpdate:!0})},checkColorChanged:function(a){this.options.data.Code10&&"undefined"!=typeof a&&a.code10&&(this.options.data.Code10=a.code10.toLowerCase())},reloadSlider:function(){this.notify("yTos::Ui::Slider::Reload",{$slider:this.$el.find("[data-ytos-promotionsList]"),settings:{sliderElement:"[data-ytos-promo]",mode:this.availableModes[this.options.data.PromotionsOptions.PromotionLayoutTypes],pause:this.options.data.PromotionsOptions.SliderPeriodMs||this.defaults.SliderPeriodMs,speed:this.options.data.PromotionsOptions.SlidingEffectDurationMs||this.defaults.SlidingEffectDurationMs}},{scope:this.scope})}}),yTos.helpers.Promotion.SelfUpdater});