"use strict";!function($,$Y){var e='[data-component-name="search-refinements-bar"]',t='[data-component-name="search-products"]',s=".filters-actions",o=".filters-toggle",i=".refinements",n='[data-component-name="gridr"]',a="filters-opened",r="filters-applied",d="selected",c="open",l="dept-search grid-search"===$("[data-sr-type]").data("srType"),f=0,h=0,p=0,m=0,u=$('[data-component-name="search-filter-layer"]'),y=void 0,v=function(){var e={};e[yTos.customEvents.OPEN_FILTER_LAYER]=O,e[yTos.customEvents.CLOSE_FILTER_LAYER]=R,e[$Y.customEvents.WINDOW_SCROLLED]=x,e[$Y.customEvents.WINDOW_ORIENTATIONCHANGE]=w,$Y.watch(e),$Y.watch({"yTos::Search::filtersFullReset":function(){b(),C()},"yTos::Search::filtersUpdated":b,"yTos::Search::filterAdded":C,"yTos::Search::filterRemoved":C,"Store::LazyLoad:products.js":g})},C=function(e){$(t).addClass("filtering"),L(e)},g=function(){$(t).removeClass("filtering")},T=function(){u.stick_in_parent({spacer:!1}).on("sticky_kit:unstick",function(e){u.css({"padding-top":"0px"})}),u.find("[data-collapsible]").on($Y.clickEvent,function(){u.css({top:"0px"}).trigger("sticky_kit:resetOffset"),E()})},E=function(){setTimeout(function(){u.css({top:"0px"}).trigger("sticky_kit:resetOffset"),u.trigger("sticky_kit:recalc"),$(t).css("min-height",u.height()+50)},400)},k=function(e){e?($("main.container").addClass(a),$("html,body").addClass("html-is-locked"),l&&$(n).addClass(r)):($("main.container").removeClass(a),$("html,body").removeClass("html-is-locked"),l&&$(n).removeClass(r))},_=function(){var e=u.find(".head").outerHeight()+u.find(".foot").outerHeight();u.find(".filters").css("height",$(window).outerHeight()-e)},b=function(){var t=u.find(".refinements .selected").not('[data-ytos-button="viewall"]').length;$Y.hasMobileBehaviour?(t>0?(u.find(".foot").addClass(r),$(e).find(s).addClass(r),t===Number(u.attr("data-filter-applied"))?u.find(".foot").addClass("filters-close"):u.find(".foot").removeClass("filters-close"),$(e).find(o+" .text").hide().filter(".applied").show().find(".count").text(t)):(u.find(".foot").removeClass(r).removeClass("filters-close"),$(e).find(s).removeClass(r),$(e).find(o+" .text").show().filter(".applied").hide()),_()):t>0?($(e).find(o+" .text").hide().filter(".applied").show().find(".count").text(t),$(e).find(s).addClass(r)):($(e).find(o+" .text").show().filter(".applied").hide(),$(e).find(s).removeClass(r)),S(t)},L=function(t){void 0===t||$Y.hasMobileBehaviour||"page"===t.key||"brand"===t.key||"sortRule"===t.key||(0===m&&(m=$(e).offset().top-h-$(e).height()-p),$("html, body").animate({scrollTop:m},100))},w=function(){R(),$Y.hasMobileBehaviour?_():(A(),$Y.hasMobileBehaviour||("function"!=typeof $.fn.stick_in_parent?reqVendors(["jquery.sticky-kit"],function(){T()}):(u.trigger("sticky_kit:detach"),T())))},O=function(){$Y.hasMobileBehaviour?(yTos.notify(yTos.customEvents.OPEN_SITE_OVERLAY),setTimeout(function(){k(!0),u.animate({top:"0",opacity:"1"},800),b(),u.addClass(c),$(e).find(s).addClass(a)},400)):(u.css("position","inherit").removeAttr("style"),$(t).addClass(a),A(),u.addClass(c),$(e).find(s).addClass(a))},R=function(){$Y.hasMobileBehaviour?(u.animate({top:"100vh",opacity:"0"},800),setTimeout(function(){yTos.notify(yTos.customEvents.CLOSE_SITE_OVERLAY),k(!1),u.removeClass(c)},800)):(u.css("position","absolute").removeClass(c),$(t).removeClass(a),A()),$(e).find(".filters-actions").removeClass(a),$(".refinementContainer").removeClass(d).find(i).hide()},S=function(e){u.attr("data-filter-applied",e)},x=function(e){$Y.hasMobileBehaviour||e.top>y&&($("html").hasClass("macro-marchio")?"down"===e.direction?u.css({"padding-top":h}):u.css({"padding-top":h+f+p}):"down"===e.direction?u.css({"padding-top":h+f}):u.css({"padding-top":h+f+p}))},A=function(){y=u.offset().top};$Y.watchOne({"yTos::HelperLoaded::search.refinements":function(){f=$('[data-component-name="header-topbar"]').height(),h=$('[data-component-name="navigation-menu"]').height(),p=$('[data-component-name="header-promo"]').height(),A(),$('[data-sr-type="text-search"]').length>0&&$(window).width()<1024&&u.removeClass(c),u.on(yTos.clickEvent,".refinementContainer .wrapper-title",function(){var e=$(this).parent();e.find(i).slideToggle(300),e.toggleClass(d).siblings().removeClass(d).find(i).slideUp(200)}).on(yTos.clickEvent,".close.btn,.apply.btn",function(){yTos.notify(yTos.customEvents.CLOSE_FILTER_LAYER)}).on(yTos.clickEvent,".head .icon",function(){yTos.notify(yTos.customEvents.CLOSE_FILTER_LAYER)}),v(),$Y.hasMobileBehaviour?_():reqVendors(["jquery.sticky-kit"],function(){T()})},"yTos::HelperParsed::search.resetFilters":function(e){e.prototype.resetFilters=function(){this.options.showTextSearchAsBreadCrumb&&(yTos.search.textSearch=""),yTos.search.page=1,this.model.emptyFilters(),S(0)}}})}(jQuery,yTos);
//# sourceMappingURL=search-filter-layer.js.map
