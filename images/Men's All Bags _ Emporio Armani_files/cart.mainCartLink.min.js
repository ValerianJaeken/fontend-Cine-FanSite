define(["ytos.cart"],function(a){return yTos.utils.namespace("yTos.helpers.Cart.MainCartLink"),yTos.helpers.Cart.MainCartLink=yTos.helpers.base.extend({initialize:function(){this._model=this._getModel(this.$el),this.options.preventDefaultBehaviour&&this.$el.on("click","a",function(a){a.preventDefault()}),this.update()},events:{mouseenter:"cartLinkMouseEnter",mouseleave:"yTos::Cart::CartLinkMouseLeave",click:"cartLinkClicked"},globalMessages:{"yTos::Cart::ItemsAdded":"update","yTos::Item::ItemAdded":"update","yTos::Item::ItemAddedToShoppingBag":"update","yTos::Account::UserLoggedIn":"update","yTos::Account::UserLoggedOut":"update","yTos::Cart::ItemRemoved":"update","yTos::Cart::ItemsDeleted":"update","yTos::Account::ItemAddedToCart":"update","yTos::Cart::ItemsInCartQuantityUpdated":"update","yTos::Cart::ErrorChangingItemsDetail":"update","yTos::Cart::ShowMiniCart":"activate","yTos::Cart::HideMiniCart":"deactivate"},form:{},_getModel:function(a){return a.find("[data-ytos-mdl]").data("ytos-mdl")},cartLinkMouseEnter:function(){this.notify("yTos::Cart::CartLinkMouseEnter",{itemsInCart:this._model.itemsInCart})},cartLinkClicked:function(){this.notify("yTos::Cart::CartLinkClicked",{itemsInCart:this._model.itemsInCart,isDefaultBehaviourDisabled:this.options.preventDefaultBehaviour})},activate:function(){this.$el.addClass("active")},deactivate:function(){this.$el.removeClass("active")},update:function(){this.getHTML("/yTos/Plugins/CartPlugin/RenderMainCartLink",{data:this.options,success:function(a){this._model=this._getModel($(a)),this.notify("yTos::Cart::MainCartLinkUpdated")}.bind(this),stripMe:!0,autoUpdate:!0})}}),yTos.helpers.Cart.MainCartLink});