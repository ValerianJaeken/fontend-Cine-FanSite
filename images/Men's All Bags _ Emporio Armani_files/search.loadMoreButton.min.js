define(["ytos.search"],function(){"use strict";return yTos.utils.namespace("yTos.helpers.Search.LoadMoreButton"),yTos.helpers.Search.LoadMoreButton=yTos.helpers.base.extend({initialize:function(){this.model=yTos.models.Searches({scope:"mainSearch"}),this.options.hasComplexLabel&&this.updateHtml()},events:{click:"loadMoreItems"},globalMessages:function(){return this.options.hasComplexLabel?{"yTos::Search::ProductsReady":"updateHtml"}:{"yTos::Search::PaginationUpdated":"updateHtml","yTos::Search::filtersUpdated":"updateHtml","yTos::Search::AllProductsReady":"updateHtml"}},loadMoreItems:function(){if(this.shouldLoadMore()){var a=Number(yTos.search.page)+1;this.model.setFilter({key:"page",value:a})}},updateHtml:function(){if(!this.options.hasComplexLabel)return void this.toggleDisabledAttribute();var a=this.getApiRequest(),b=$Y.prepareData({productsPerPage:this.options.productsPerPage,pagesLoaded:Number(yTos.search.page)-1,Options:{SiteCode:this.options.siteCode,Gender:a.gender,DepartmentCode:a.department,ApiRequest:$Y.jsonToQueryString(a)}});this.postHTML({Plugin:"Search",Action:"RenderLoadMoreButtonAsync"},{success:function(a){this.toggleDisabledAttribute(),$Y.notify("yTos::Search::LoadMoreButtonUpdated",{content:a})}.bind(this),data:b,autoUpdate:!0,stripMe:!0})},shouldLoadMore:function(){return Number(yTos.search.page)<Number(yTos.search.totalPages)},toggleDisabledAttribute:function(){this.$el.prop("disabled",!this.shouldLoadMore())},getApiRequest:function(){var a=this.model.get("filters");return $Y.mixin({},a,!0)}}),yTos.helpers.Search.LoadMoreButton});